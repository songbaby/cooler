<script type="text/JavaScript" src='{$Think.const.JS_URL}jquery_1.6.1.js'></script>


{/* 这是模板注释内容*/ }

<style>
#countydiv{text-align: left}
#towndiv{text-align: left}

#CountyList {text-align: center;color: gray}
#MapNav_Area_Menu {color: #9B410E;    width: 500px;  height:400px;background-color: #1c94c4;margin-left: 100px}


#ProvinceList{
    background-color: white;
    width: 300px;
    height:auto;
    position: absolute;
    top: 25px;
    left: 30px;
    z-index: 999;
    opacity: 0.9;
}
#CityList {
    background-color: rebeccapurple;
    width: 200px;
    height:400px;
    position: absolute;
    top: 30px;
    left: 10px;
    z-index: 99;
    opacity: 0.9;
}
#CountyList {
    background-color: gray;
    width: 200px;
    height:400px;
    position: absolute;
    top: 30px;
    left: 210px;
    z-index: 99;
    opacity: 0.9;
}


</style>

<script >

    var   m_ProviceCurrent ="上海市"

</script>

<div class='top-list-wrap' style="background-color: #0e924c">
    <div class='top-list'>
        <ul  class='l-list'>
           <li> <div id="ProviceCurrent" >  </div> </li>
        </ul>

    </div>
</div>



<div id="nav" style="background-color: #9B410E">
    <div align="left">
        <div id='countydiv'>
        </div>

        <div id='towndiv'>
        </div>

    </div>
</div>



<script >


    function GetProvinceCurrent(obj) {
        m_ProviceCurrent = obj.id;
        $('#ProviceCurrent').html(m_ProviceCurrent);


    }


    $(function(){

        $('#ProviceCurrent').html(m_ProviceCurrent);
        var   allstr = '{$allstr}';
        var allarray=eval("("+allstr+")");

        var txtHtml ="";
        $.each(allarray,function(key,val){
           if(val.pid == 1 ) {
               txtHtml += '<a href="#" onclick="GetProvinceCurrent(this)" id='+val.province+'>'+ " " +val.province +'</a>';
            }
        });



        $("#nav").append(" <div id='ProvinceList'> </id>");
        $('#ProviceCurrent').live('mouseover',function() {
            $('#ProvinceList').show();
        })

        $('#ProvinceList').live('mouseleave',function() {
            $('#ProvinceList').hide();
        })
        var actionmane = "{$Think.const.ACTION_NAME}";
        if(actionmane == "showmap" || actionmane == "showlist"){
            $("#ProvinceList").html(txtHtml);
        }




        $("#nav").append(" <div id='CityList'> </id>");
        $("#CityList").show();

        $("#CityList").append(" <div id='CityListTopBar'> </id>");
        $("#CityListTopBar").html("区域");

        $("#nav").append(" <div id='CountyList'> gg</id>");
        $('#CountyList').hide();


        $('#CityListTopBar').live('mouseover',function() {
            $('#CountyList').show();
        })

        $('#CountyList').live('mouseleave',function() {
            $('#CountyList').hide();
        })





        $('#countydiv > a').live('click',function() {

            var id =$(this).attr('id');
            currentcounty=$(this).html();

            var txtHtml ="";
            $.each(allarray,function(key,val){
                if(val.pid == id) {
                    txtHtml += '<a href="#" id='+val.id+'>'+ " " +val.city +'</a>';
                }
            });
            $("#towndiv ").html(txtHtml);

            $("#MapNav_Area_Menu ").html(txtHtml);

            $.post("__MODULE__/Cooler/getcooler", {
                cid :  id ,
            }, function (data, textStatus){



                var actionmane = "{$Think.const.ACTION_NAME}";
                if(actionmane == "showmap"){
                    displaymap(data);
                }else{
                    displaylist(data);
                }



            },"json");


        })

        $('#towndiv > a').live('click',function() {

            var id =$(this).attr('id');

            $.post("__MODULE__/Cooler/getcooler", {
                cid :  id ,
            }, function (data, textStatus){

                var actionmane = "{$Think.const.ACTION_NAME}";
                if(actionmane == "showmap"){
                    displaymap(data);
                }else{
                    displaylist(data);
                }

            },"json");

        })

        })


</script>

